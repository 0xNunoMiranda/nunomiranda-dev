name: Deploy Check

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Validate HTML structure
        run: |
          echo "ğŸ” Validating HTML files..."
          if [ -f "index.html" ]; then
            echo "âœ… index.html exists"
            # VerificaÃ§Ã£o bÃ¡sica da estrutura HTML
            if grep -q "<!DOCTYPE html>" index.html && \
               grep -q "<html" index.html && \
               grep -q "</html>" index.html && \
               grep -q "<head>" index.html && \
               grep -q "</head>" index.html && \
               grep -q "<body>" index.html && \
               grep -q "</body>" index.html; then
              echo "âœ… HTML structure is valid"
            else
              echo "âŒ HTML structure validation failed"
              exit 1
            fi
          else
            echo "âŒ index.html not found"
            exit 1
          fi
      
      - name: Check CNAME file
        run: |
          echo "ğŸ” Checking CNAME configuration..."
          if [ -f "CNAME" ]; then
            echo "âœ… CNAME file exists"
            echo "ğŸ“„ Content: $(cat CNAME)"
            if grep -q "nunomiranda.dev" CNAME; then
              echo "âœ… CNAME contains valid domain"
            else
              echo "âš ï¸ CNAME domain may not be correct"
            fi
          else
            echo "âŒ CNAME file not found"
            exit 1
          fi
      
      - name: Verify required files
        run: |
          echo "ğŸ” Checking for required files..."
          files=("index.html" "styles.css" "script.js" "CNAME" "README.md")
          all_found=true
          for file in "${files[@]}"; do
            if [ -f "$file" ]; then
              echo "âœ… $file found"
            else
              echo "âŒ $file not found"
              all_found=false
            fi
          done
          if [ "$all_found" = false ]; then
            exit 1
          fi
      
      - name: Check for Portuguese language
        run: |
          echo "ğŸ” Verifying Portuguese language settings..."
          if grep -q 'lang="pt-PT"' index.html || grep -q 'lang="pt"' index.html; then
            echo "âœ… Portuguese language configured"
          else
            echo "âš ï¸ Portuguese language not configured in HTML"
          fi
      
      - name: Summary
        if: success()
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ‰ All validation checks passed!"
          echo "âœ… Website is ready for deployment"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
