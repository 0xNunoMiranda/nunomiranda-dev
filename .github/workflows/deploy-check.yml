name: Deploy Check

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Verify required files
        run: |
          set -euo pipefail
          echo "ğŸ” Checking for required files..."
          files=("index.html" "styles.css" "script.js" "CNAME" "README.md")
          for file in "${files[@]}"; do
            test -f "$file" && echo "âœ… $file found" || (echo "âŒ $file not found" && exit 1)
          done

      - name: Validate basic HTML structure
        run: |
          set -euo pipefail
          echo "ğŸ” Validating HTML structure..."
          if grep -q "<html" index.html && grep -q "</html>" index.html && grep -q "<head" index.html && grep -q "</head>" index.html && grep -q "<body" index.html && grep -q "</body>" index.html; then
            echo "âœ… HTML structure looks OK"
          else
            echo "âŒ HTML structure validation failed"
            exit 1
          fi

      - name: Check CNAME file
        run: |
          set -euo pipefail
          echo "ğŸ” Checking CNAME configuration..."
          domain="$(tr -d '\r\n' < CNAME)"
          echo "ğŸ“„ Content: ${domain}"
          if [ -z "${domain}" ]; then
            echo "âŒ CNAME is empty"
            exit 1
          fi

      - name: Summary
        if: success()
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ‰ All validation checks passed!"
          echo "âœ… Website is ready for deployment"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
